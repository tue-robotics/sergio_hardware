########################################################################
#                                                                      #
# Simple Open EtherCAT Master (SOEM) deployer file 				   	   #
#                                                                      #
########################################################################

#### IMPORT PACKAGE ####
import("rtt_ros")
ros.import("sergio_hardware")
ros.import("amigo_hardware")

#### DECLARATION OF PARAMETERS ####
var double 	Ts = 0.001
var string file = "/home/ton/Dropbox/Linux/Matlab/Torso/Idetification/test.txt"
var string fileout = "/home/ton/Dropbox/Linux/Matlab/Torso/Idetification/test.dat"
var array MINPOS                = array(0.244, 0.360); # min spindle length [m]
var array MAXPOS                = array(0.394, 0.456); # max spindle length [m]


### Ref component ###
loadComponent("RefTrajectory","SERGIOCUSTOM::RefTrajectory")
setActivity("RefTrajectory",Ts,HighestPriority,ORO_SCHED_RT)
RefTrajectory.ref_size = 29835
RefTrajectory.file = file
RefTrajectory.min_ref = MINPOS
RefTrajectory.max_ref = MAXPOS
RefTrajectory.configure

### TRACING COMPONENT ###
loadComponent("Tracing","Signal::Tracing")
setActivity("Tracing",0.0,HighestPriority,ORO_SCHED_RT)
Tracing.vector_sizes = array (2.0) 
Tracing.buffersize = 29835;
Tracing.filename = fileout;
Tracing.Ts = Ts
Tracing.configure

connect ("RefTrajectory.out",	    "Tracing.in1", ConnPolicy() );

Tracing.start();